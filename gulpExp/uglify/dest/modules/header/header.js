define(function(require,exports,module){var format=require("modules/tools").format;MVC.addView("header",function(M){var html,dom=document.getElementById("header"),data=M.get("header"),tpl=['<div class="container">','<div class="top clearfix">','<h1 class="fl"><img src="imgs/logo.png" alt="" /></h1>','<ul class="fr clearfix"><%icon_tpl%></ul>',"</div>",'<div class="nav">','<ul class="clearfix"><%nav_tpl%></ul>',"</div>","</div>"].join(""),icon_html="",nav_html="";return data.icon.forEach(function(value,index){icon_html+=format('<li class="fl"><a href="<%href%>"><img src="imgs/<%img%>" alt="" /></a></li>',value)}),console.log(icon_html),data.nav.forEach(function(value,index){var li_html="";(value.list||[]).forEach(function(val,idx){li_html+=format('<li><a href="<%href%>"><%title%></a></li>',val)}),nav_html+=format('<li class="fl"><a href="<%href%>"><%title%></a><ul><%li_tpl%></ul></li>',{href:value.href,title:value.title,li_tpl:li_html})}),console.log(nav_html),html=format(tpl,{icon_tpl:icon_html,nav_tpl:nav_html}),dom.innerHTML=html,dom}),MVC.addCtrl("header",function(M,V){$.ajax({url:"/data/header.json",data:"",type:"get",dataType:"json",success:function(data){console.log(data),M.add("header",data);var dom=V.create("header"),$lis=$(dom).find(".nav>ul>li");$lis.mouseenter(function(){$(this).children("ul").is(":empty")||$(this).children("ul").slideDown()}),$lis.mouseleave(function(){$(this).children("ul").slideUp()})}})})});